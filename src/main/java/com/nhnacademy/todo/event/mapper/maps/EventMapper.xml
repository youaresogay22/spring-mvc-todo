<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.nhnacademy.todo.event.mapper.EventMapper">

    <insert id="save">
        insert into events set
        event_id= #{event.id},
        user_id= #{event.userId},
        subject= #{event.subject},
        event_at= #{event.eventAt},
        created_at= #{event.createdAt}
    </insert>

    <delete id="delete">
        DELETE FROM events
        WHERE event_at= #{todoDate} AND event_id= #{eventId}
    </delete>

    <delete id="deleteTodoItem">
        DELETE FROM events
        WHERE event_id= #{eventId}
    </delete>

    <delete id="deleteTodoItemOfDay">
        DELETE FROM events
        WHERE event_at= #{todoDate}
    </delete>


    <select id="getTodoItem" resultType="com.nhnacademy.todo.event.domain.Event">
        SELECT event_id, event_at, subject
        FROM events
        WHERE event_id= #{eventId}
    </select>

    <select id="getTodoItemListOfDay" resultType="java.util.Optional">
        SELECT event_id, event_at, subject
        FROM events
        WHERE DATE_FORMAT(event_at, '%Y-%m-%d') = '#{year}-#{month}-#{day}'
    </select>

    <select id="getTodoItemListOfMonth" resultType="java.util.Optional">
        SELECT event_id, event_at, subject
        FROM events
        WHERE DATE_FORMAT(event_at, '%Y-%m') = '#{year}-#{month}'
    </select>


    <select id="countByTodoDate" resultType="java.lang.Integer">
        select count(*) as count
        from events
        where DATE_FORMAT(event_at, '%Y-%m-%d') = '#{year}-#{month}-#{day}'
    </select>


</mapper>